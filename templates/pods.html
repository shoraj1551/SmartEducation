{% extends "layouts/dashboard_base.html" %}

{% block title %}Accountability Pods | SmartEducation{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="/static/css/pod-enhancements.css">
{% endblock %}

{% block content %}
<div class="pods-container">
    <div class="section-header">
        <h1>Accountability Pod</h1>
    </div>

    <!-- PENDING INVITES -->
    <div id="pendingArea" style="display:none; margin-bottom:2rem;">
        <div class="section-header">
            <h3>ğŸ”” Pending Invites</h3>
        </div>
        <div id="pendingList"></div>
    </div>

    <!-- ACTIVE POD -->
    <div class="pod-section">
        <div class="section-header">
            <h3>ğŸ‘¥ My Pod</h3>
            <span style="font-size:0.9rem; opacity:0.6;">Stay consistent together.</span>
        </div>
        <div id="podGrid" class="pod-grid">
            <div class="loading-spinner"><i class="fas fa-circle-notch fa-spin"></i> Loading pod...</div>
        </div>
    </div>

    <!-- INVITE -->
    <div class="pod-section">
        <div class="section-header">
            <h3>âœ‰ï¸ Invite Partner</h3>
        </div>
        <div class="invite-form">
            <input type="email" id="inviteEmail" class="invite-input" placeholder="friend@example.com">
            <button class="primary-btn nav-btn" onclick="sendInvite()">Send Invite</button>
        </div>
    </div>

    <!-- Shared Content Section -->
    <div class="pod-section">
        <div class="section-header">
            <h3>ğŸ“š Shared with Me</h3>
            <span style="font-size:0.9rem; opacity:0.6;">Content your friends are sharing</span>
        </div>
        <div id="sharedContent" class="shared-content-grid"
            style="display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 1rem;">
            <div style="text-align: center; padding: 2rem; opacity: 0.5; grid-column: 1/-1;">
                <i class="fas fa-circle-notch fa-spin"></i> Loading shared content...
            </div>
        </div>
    </div>

    <!-- Message Modal -->
    <div class="modal" id="messageModal" style="display: none;">
        <div class="modal-card"
            style="max-width: 600px; background: linear-gradient(135deg, rgba(30, 41, 59, 0.98) 0%, rgba(15, 23, 42, 0.98) 100%); backdrop-filter: blur(20px); border: 1px solid rgba(255,255,255,0.15); border-radius: 16px;">
            <div style="padding: 2rem;">
                <div
                    style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem; padding-bottom: 1rem; border-bottom: 1px solid rgba(255,255,255,0.1);">
                    <h3 id="messagePartnerName"
                        style="margin: 0; font-size: 1.5rem; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text;">
                        <i class="fas fa-comment"></i> Messages
                    </h3>
                    <button onclick="closeMessageModal()"
                        style="background: rgba(255,255,255,0.05); border: none; color: rgba(255,255,255,0.6); font-size: 1.25rem; cursor: pointer; padding: 0.5rem; border-radius: 8px; width: 36px; height: 36px; display: flex; align-items: center; justify-content: center;"
                        onmouseover="this.style.background='rgba(239,68,68,0.2)'; this.style.color='#ef4444';"
                        onmouseout="this.style.background='rgba(255,255,255,0.05)'; this.style.color='rgba(255,255,255,0.6)';">
                        <i class="fas fa-times"></i>
                    </button>
                </div>

                <div id="messageThread"
                    style="max-height: 400px; overflow-y: auto; margin-bottom: 1rem; padding: 1rem; background: rgba(0,0,0,0.2); border-radius: 8px; min-height: 200px;">
                    <p style="text-align: center; opacity: 0.5;">No messages yet. Start the conversation!</p>
                </div>

                <div style="display: flex; gap: 0.5rem;">
                    <input type="text" id="messageInput" placeholder="Type a message..."
                        style="flex: 1; padding: 0.75rem 1rem; background: rgba(255,255,255,0.05); border: 2px solid rgba(255,255,255,0.1); border-radius: 8px; color: white; outline: none;"
                        onfocus="this.style.borderColor='#667eea'"
                        onblur="this.style.borderColor='rgba(255,255,255,0.1)'"
                        onkeypress="if(event.key==='Enter') sendMessage()">
                    <button onclick="sendMessage()" class="primary-btn nav-btn"
                        style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border: none; padding: 0.75rem 1.5rem;">
                        <i class="fas fa-paper-plane"></i> Send
                    </button>
                </div>
            </div>
        </div>
    </div>

</div>
{% endblock %}

{% block extra_js %}
<script src="/static/js/pods.js"></script>
{% endblock %}